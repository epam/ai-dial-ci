name: "Prepare Java"
description: "Set up Java with Gradle"

inputs:
  java-version:
    description: "Java version to use"
    default: "17"
  java-distribution:
    description: "Java distribution to use"
    default: "temurin"
  build-scan-publish:
    description: "Whether to publish build scans to public Develocity instance (https://scans.gradle.com)"
    default: "false"

runs:
  using: "composite"
  steps:
    - name: Set up JDK
      uses: actions/setup-java@f2beeb24e141e01a676f977032f5a29d81c9e27e # v5.1.0
      with:
        java-version: ${{ inputs.java-version }}
        distribution: ${{ inputs.java-distribution }}
        # Not using `cache: gradle` because `setup-gradle` action takes care of it
        # ref: https://github.com/gradle/actions/blob/main/docs/setup-gradle.md#incompatibility-with-other-caching-mechanisms
    - name: Set up Gradle
      uses: gradle/actions/setup-gradle@f29f5a9d7b09a7c6b29859002d29d24e1674c884 # v5.0.1
      with:
        build-scan-publish: ${{ fromJSON(inputs.build-scan-publish) }}
        build-scan-terms-of-use-url: "https://gradle.com/help/legal-terms-of-use"
        build-scan-terms-of-use-agree: "yes"
        add-job-summary: ${{ fromJSON(inputs.build-scan-publish) && 'always' || 'on-failure' }}
